## Title
Отчет по остаткам товаров с непустыми назначениями в регистрах накопления

## Context & Goals

### Problem & background
В настоящее время обработка `MRS_КорректировкаНазначений` используется для исправления назначений в остатках. Однако для анализа текущего состояния и принятия решений пользователям необходим сводный отчет, который бы показывал остатки в разрезе назначений сразу по трем ключевым регистрам. Сейчас для получения этой информации требуется выполнять несколько разрозненных действий, что неудобно и замедляет работу.

### Objectives
- Реализовать новую вкладку "Отчет по назначениям" на основной форме обработки `MRS_КорректировкаНазначений`.
- Разместить на новой вкладке функционал для формирования отчета, показывающего остатки из трех регистров накопления, где указано назначение.
- Отчет должен строиться с использованием Системы Компоновки Данных (СКД).
- Генерация отчета должна запускаться по кнопке "СформироватьОтчет".

### Non-goals / Out of scope
- Создание новых объектов конфигурации, кроме тех, что необходимы для отчета в рамках существующей обработки.
- Реализация возможности редактирования данных непосредственно из отчета.
- Разработка сложного дизайна для отчета; будут использоваться стандартные возможности СКД.

## Core functions
- На форму обработки `MRS_КорректировкаНазначений` будет добавлена новая вкладка "Отчет по назначениям".
- На вкладке будет размещено поле табличного документа для вывода отчета.
- На командную панель формы будет добавлена кнопка "СформироватьОтчет".
- При нажатии на кнопку будет формироваться и выводиться в поле табличного документа отчет на основе схемы компоновки данных (СКД).

## Flows (Text-Only)
1. Пользователь открывает обработку `MRS_КорректировкаНазначений`.
2. Пользователь переходит на новую вкладку "Отчет по назначениям".
3. Область отчета на вкладке изначально пуста.
4. Пользователь нажимает кнопку "СформироватьОтчет".
5. Система формирует отчет, используя данные из трех регистров накопления на дату, указанную в поле "Дата" на основной форме обработки.
6. Сформированный отчет отображается в поле табличного документа на вкладке.

## Data & Integrations

### Core entities & important fields
Отчет будет использовать данные об остатках из трех регистров накопления:
1.  `РегистрНакопления.СебестоимостьТоваров`
2.  `РегистрНакопления.ТоварыОрганизаций`
3.  `РегистрНакопления.ТоварыНаСкладах`

Основным условием отбора записей является то, что измерение `Назначение` (или `АналитикаУчетаНоменклатуры.Назначение`) не является пустой ссылкой. В качестве параметра для получения остатков используется реквизит `Дата` с формы обработки.

### External systems/APIs/integrations
Внешние интеграции не требуются.

## Metadata
### Модифицируемые объекты
- **`Обработка.MRS_КорректировкаНазначений`**:
    - **`Форма.Форма`**:
        - Добавить новую страницу (вкладку) с именем `ОтчетПоНазначениям` и заголовком "Отчет по назначениям".
        - На новую вкладку добавить новый элемент формы типа `ПолеТабличногоДокумента` с именем `РезультатОтчета`.
        - Добавить новую команду формы `СформироватьОтчет` с одноименным обработчиком действия.
        - Разместить на форме кнопку, связанную с командой `СформироватьОтчет`.
        - В модуле формы реализовать обработчик команды `СформироватьОтчет`, который будет выполнять формирование отчета.
    - **Макеты**:
        - Добавить новый макет с именем `СхемаОтчетаПоНазначениям` для хранения схемы компоновки данных.

### Схема Компоновки Данных (содержимое макета `СхемаОтчетаПоНазначениям`)
- **Наборы данных**:
    - Схема должна включать три набора данных типа "Запрос". Каждый запрос соответствует одному из запросов, уже существующих в модуле формы обработки.
    - **НаборДанных1 (СебестоимостьТоваров)**:
        - Источник: `РегистрНакопления.СебестоимостьТоваров.Остатки`
        - Параметры: `&Дата`
        - Условие: `СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Назначение <> ЗНАЧЕНИЕ(Справочник.Назначения.ПустаяСсылка)`
    - **НаборДанных2 (ТоварыОрганизаций)**:
        - Источник: `РегистрНакопления.ТоварыОрганизаций.Остатки`
        - Параметры: `&Дата`
        - Условие: `ТоварыОрганизацийОстатки.АналитикаУчетаНоменклатуры.Назначение <> ЗНАЧЕНИЕ(Справочник.Назначения.ПустаяСсылка)`
    - **НаборДанных3 (ТоварыНаСкладах)**:
        - Источник: `РегистрНакопления.ТоварыНаСкладах.Остатки`
        - Параметры: `&Дата`
        - Условие: `ТоварыНаСкладахОстатки.Назначение <> ЗНАЧЕНИЕ(Справочник.Назначения.ПустаяСсылка)`
- **Связи наборов данных**:
    - Наборы данных не связываются между собой. Отчет должен выводить данные последовательно.
- **Настройки отчета**:
    - Создать три варианта группировок, по одной для каждого регистра.
    - **Группировка 1 (Себестоимость)**:
        - Таблица с детальными записями из `НаборДанных1`.
        - Выводимые поля: `АналитикаУчетаНоменклатуры`, `КоличествоОстаток`, `СтоимостьОстаток` и другие ключевые ресурсы.
    - **Группировка 2 (Товары организаций)**:
        - Таблица с детальными записями из `НаборДанных2`.
        - Выводимые поля: `АналитикаУчетаНоменклатуры`, `КоличествоОстаток`.
    - **Группировка 3 (Товары на складах)**:
        - Таблица с детальными записями из `НаборДанных3`.
        - Выводимые поля: `Номенклатура`, `Характеристика`, `Назначение`, `Склад`, `ВНаличииОстаток`, `КОтгрузкеОстаток`.
    - Каждой таблице в отчете должен предшествовать заголовок, указывающий на источник данных (например, "Остатки по регистру 'Себестоимость товаров'").
